#include <gtest/gtest.h>  
#include <cstdio>

#include "AESDataBlock.hpp"

TEST(AESDataBlock_Tests, right_shift_8_test){
    unsigned char starting_value[16] = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff};
    unsigned char expected_value[16] = {0x00, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF};
    AESDataBlock block = AESDataBlock(starting_value);
    block.print();
    block >> 8;
    block.print();
    AESDataBlock expected_block = {expected_value};
    EXPECT_EQ(block, expected_block);
}
TEST(AESDataBlock_Tests, right_shift_1_test){
    unsigned char starting_value[16] = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff};
    unsigned char expected_value[16] = {0x7f, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF};
    AESDataBlock block = AESDataBlock(starting_value);
    block.print();
    block >> 1;
    block.print();
    AESDataBlock expected_block = {expected_value};
    EXPECT_EQ(block, expected_block);
}

TEST(AESDataBlock_Tests, right_shift_17_test){
    unsigned char starting_value[16] = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff};
    unsigned char expected_value[16] = {0x00, 0x00, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF};
    AESDataBlock block = AESDataBlock(starting_value);
    block.print();
    block >> 17;
    block.print();
    AESDataBlock expected_block = {expected_value};
    EXPECT_EQ(block, expected_block);
}

TEST(AESDataBlock_Tests, left_shift_8_test){
    unsigned char starting_value[16] = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff};
    unsigned char expected_value[16] = {0xff, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x00};
    AESDataBlock block = AESDataBlock(starting_value);
    block.print();
    block << 8;
    block.print();
    AESDataBlock expected_block = {expected_value};
    EXPECT_EQ(block, expected_block);
}

TEST(AESDataBlock_Tests, left_shift_1_test){
    unsigned char starting_value[16] = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff};
    unsigned char expected_value[16] = {0xff, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xfe};
    AESDataBlock block = AESDataBlock(starting_value);
    block.print();
    block << 1;
    block.print();
    AESDataBlock expected_block = {expected_value};
    EXPECT_EQ(block, expected_block);
}

TEST(AESDataBlock_Tests, left_shift_1_extra_test){
    unsigned char starting_value[16] = {0xfe, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff};
    unsigned char expected_value[16] = {0xfd, 0xFD, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xfe};
    AESDataBlock block = AESDataBlock(starting_value);
    block.print();
    block << 1;
    block.print();
    AESDataBlock expected_block = {expected_value};
    EXPECT_EQ(block, expected_block);
}

TEST(AESDataBlock_Tests, left_shift_23_test){
    unsigned char starting_value[16] = {0xfe, 0xfe, 0xff, 0xff, 0xff, 0xab, 0xff, 0xff, 0xff, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff};
    unsigned char expected_value[16] = {0xFF, 0xFF, 0xD5, 0xFF, 0xFF, 0xFF, 0x80, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x80, 0x00, 0x00};
    AESDataBlock block = AESDataBlock(starting_value);
    block.print();
    block << 23;
    block.print();
    AESDataBlock expected_block = {expected_value};
    EXPECT_EQ(block, expected_block);
}